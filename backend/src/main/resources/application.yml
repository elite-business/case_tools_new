spring:
  application:
    name: CaseTools
    version: 2.0.0

  profiles:
    active: ${SPRING_PROFILES_ACTIVE}

  datasource:
    url: ${DATABASE_URL}
    username: ${DATABASE_USERNAME}
    password: ${DATABASE_PASSWORD}
    driver-class-name: ${DATABASE_DRIVER}
    hikari:
      maximum-pool-size: ${DB_POOL_MAX}
      minimum-idle: ${DB_POOL_MIN}
      connection-timeout: 30000
      idle-timeout: 600000
      max-lifetime: 1800000

  jpa:
    database-platform: org.hibernate.dialect.PostgreSQLDialect
    hibernate:
      ddl-auto: ${HIBERNATE_DDL_AUTO}
    show-sql: ${HIBERNATE_SHOW_SQL}
    properties:
      hibernate:
        format_sql: ${HIBERNATE_FORMAT_SQL}
        jdbc:
          lob.non_contextual_creation: true
          batch_size: 20
        default_schema: casemanagment
        use_sql_comments: false
        order_inserts: true
        order_updates: true

  liquibase:
    enabled: ${LIQUIBASE_ENABLED:false}
    change-log: classpath:db/changelog/db.changelog-master.xml

  mail:
    host: ${MAIL_HOST}
    port: ${MAIL_PORT}
    username: ${MAIL_USERNAME}
    password: ${MAIL_PASSWORD}
    test-connection: false
    properties:
      mail.smtp:
        auth: true
        starttls.enable: true
        connectiontimeout: 5000
        timeout: 5000
        writetimeout: 5000

  security:
    jwt:
      secret: ${JWT_SECRET}
      expiration: ${JWT_EXPIRATION_MS:3600000}
      refresh-expiration: ${JWT_REFRESH_EXPIRATION_MS:86400000}

server:
  port: ${SERVER_PORT}
  servlet:
    context-path: ${CONTEXT_PATH:/api}
  error:
    include-message: never
    include-binding-errors: never
    include-stacktrace: on_param
    include-exception: false

management:
  endpoints:
    web:
      base-path: /actuator
      exposure:
        include: ${ACTUATOR_ENDPOINTS:health,metrics,prometheus}
  endpoint:
    health:
      show-details: ${HEALTH_SHOW_DETAILS:never}

logging:
  level:
    root: ${LOGGING_LEVEL_ROOT:WARN}
    com.elite.casetools: ${LOGGING_LEVEL_APP:INFO}
    org.springframework.security: ${LOGGING_LEVEL_SECURITY:WARN}
    org.hibernate.SQL: ${LOGGING_LEVEL_SQL:WARN}
    org.hibernate.type.descriptor.sql.BasicBinder: ${LOGGING_LEVEL_SQL_BIND:WARN}
  pattern:
    console: "%d{yyyy-MM-dd HH:mm:ss} - %msg%n"
    file: "%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level %logger{36} - %msg%n"

# ========================
# Grafana Integration
# ========================
grafana:
  url: ${GRAFANA_URL}
  api-token: ${GRAFANA_API_KEY}
  datasource-uid: ${GRAFANA_DATASOURCE_UID}
  folder-uid: ${GRAFANA_FOLDER_UID}
  notification-channel-uid: ${GRAFANA_NOTIFICATION_CHANNEL:webhook}
  timeout: ${GRAFANA_TIMEOUT:30000}
  validate-ssl: ${GRAFANA_VALIDATE_SSL:false}
  organization-id: ${GRAFANA_ORGANIZATION_ID:1}
  webhook:
    secret: ${GRAFANA_WEBHOOK_SECRET}

# ========================
# Application Configuration
# ========================
application:
  cors:
    allowed-origins: ${CORS_ORIGINS}
    allowed-methods: GET, POST, PUT, DELETE, OPTIONS
    allowed-headers: "*"
    allow-credentials: true
    max-age: 3600

  notification:
    email:
      enabled: false
      from: ${EMAIL_FROM:alerts@elite.com}
      from-name: CaseTools Alerts
    webhook:
      enabled: true
      retry-attempts: 3
      retry-delay: 5000

  alert:
    duplicate-window-minutes: 5
    auto-assign: true
    sla:
      critical-minutes: 15
      high-minutes: 60
      medium-minutes: 240
      low-minutes: 1440

  case:
    auto-close-resolved: true
    retention-days: 365

  rule-builder:
    max-query-execution-time: 30000
    max-result-rows: 1000
    test-mode-enabled: true

# ========================
# API Documentation
# ========================
springdoc:
  api-docs:
    enabled: ${SWAGGER_ENABLED:false}
    path: /v3/api-docs
  swagger-ui:
    enabled: ${SWAGGER_ENABLED:false}
    path: /swagger-ui.html
    try-it-out-enabled: false
    filter: true
